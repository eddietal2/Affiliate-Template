<!-- Mobile Header -->
<ion-header class="ion-hide-lg-up">

  <ion-toolbar>
    <ion-buttons slot="start">

      <!-- Logo -->
      <img id="logo" height="30" src="../../../assets/placeholders/placeholder-logo.svg" alt="Logo">
      
      <!-- Searchbar -->
      <ion-searchbar 
        id="search-bar"
        placeholder="{{this.searchBarMessage}}"
        nputmode="decimal" 
        type="decimal" 
        [debounce]="250"
        (ionChange)="onSearchChange($event)"
        showCancelButton="always">
      </ion-searchbar>
    </ion-buttons>

    <!-- Filter -->
    <ion-buttons id="filter-button" slot="end">
      <ion-button (click)="openFilterActionSheet()">
        <ion-icon name="filter-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content #productsPageContent [scrollEvents]="true" (ionScroll)="scrollPosition($event)">
  <div id="featured-return-position"></div>
  <ion-grid>

    <!-- Skeleton UI -->
    <div *ngIf="this.skeletonData">
      <div class="ion-padding custom-skeleton">
        <ion-list>
          <ion-item lines="none">
            <ion-label>
              <h3>
                <ion-skeleton-text class="is-square" animated></ion-skeleton-text>
              </h3>
              <p>
                <ion-skeleton-text class="is-text" animated style="width: 80%"></ion-skeleton-text>
              </p>
              <p>
                <ion-skeleton-text class="is-text" animated style="width: 70%"></ion-skeleton-text>
              </p>
              <p>
                <ion-skeleton-text class="is-text" animated style="width: 60%"></ion-skeleton-text>
              </p>
            </ion-label>
          </ion-item>
        </ion-list>
      </div>
    </div>

    <!-- Products -->
    <ng-container *ngIf="!this.searching">

      <ion-accordion-group 
        value="all" 
        id="accordian-group"
        (ionChange)="accordianChange($event)">

        <!-- Featured Products -->
        <ion-accordion value="featured" id="featured-products-accordian">
          
          <ion-item id="featured-products-item" lines="none" slot="header">
            <ion-label>Featured Products | {{this.staticFeaturedProducts.length}}</ion-label>
            <ion-icon name="pricetag-outline" slot="start"></ion-icon>
          </ion-item>

          <ion-list slot="content">

            <div id="feature-swiper-overlay"></div>

            <!-- Featured Products -->
            <swiper
              id="featured-swiper"
              [config]="featuredSwiperConfig" 
              (swiper)="onSwiper($event)">
                <ng-template swiperSlide *ngFor="let featuredProduct of staticFeaturedProducts">
                  <ion-row
                    class="featured-product product-wrapper ion-justify-content-center">
                    <ion-col (click)="goToProductPage()" class="product-photo" size="6">

                    </ion-col>
                    <ion-col size="6">
                      <div (click)="goToProductPage()">
                        <p class="product-price">${{featuredProduct.price}}</p>
                        <h6 class="product-title">{{featuredProduct.title}}</h6>
                        <h6 class="product-rating">Rating: {{featuredProduct.rating}}</h6>
                        <p class="product-duration">Duration: {{featuredProduct.duration}} Mins</p>
                        <p class="product-category"># {{featuredProduct.category}}</p>
                        <h5 class="product-reviews-length">Reviews {{featuredProduct.reviews.length}}</h5>
                        <div class="star-container">
                        </div>
                      </div>
                      <!-- <div class="product-message-green">
                        <p>Test Message</p>
                      </div>
                      <div class="product-message-red">
                        <p>Test Message</p>
                      </div> -->
                      <ion-toolbar>
                        <ion-buttons slot="end">
                          <ion-button class="favorite-this-product-button" (click)="favorites()">
                            <ion-icon slot="start" name="heart"></ion-icon>
                          </ion-button>
                        </ion-buttons>
                      </ion-toolbar>
                    </ion-col>
                  </ion-row>

                </ng-template>
            </swiper>

          </ion-list>
        </ion-accordion>
        
        <!-- Favorite Products -->
        <ion-accordion value="favorites" id="favorite-products-accordian">
          
          <ion-item id="favorite-products-item" lines="none" slot="header">
            <ion-label>Favorite Products | {{this.staticFavoriteProducts.length}}</ion-label>
            <ion-icon name="heart" slot="start"></ion-icon>
          </ion-item>
      
          <ion-list slot="content">
        
            <!-- Products -->
            <!-- Using same data from Featured data for now -->
            <div *ngFor="let product of staticFavoriteProducts">
                <ion-row
                class="product-wrapper ion-justify-content-center">
                <ion-col (click)="this.goToProductPage()" class="product-photo" size="6">
          
                </ion-col>
                <ion-col size="6">
                  <div (click)="this.goToProductPage()">
                    <p class="product-price">${{product.price}}</p>
                    <h6 class="product-title">{{product.title}}</h6>
                    <h6 class="product-rating">Rating: {{product.rating}}</h6>
                    <p class="-product-duration">Duration: {{product.duration}} Mins</p>
                    <p class="product-category"># {{product.category}}</p>
                    <h5 class="product-reviews-length">Reviews {{product.reviews.length}}</h5>
                  </div>
                  <div class="product-message-green"></div>
                  <div class="product-message-red"></div>
                  <ion-toolbar>
                    <ion-buttons slot="end">
                      <ion-button class="favorite-this-product-button" (click)="favorites()">
                        <ion-icon slot="start" name="heart"></ion-icon>
                      </ion-button>
                    </ion-buttons>
                  </ion-toolbar>
                </ion-col>
                </ion-row>
            </div>
          </ion-list>
        </ion-accordion>

        <!-- All Products -->
        <ion-accordion value="all" id="all-products-accordian">
          
          <ion-item id="all-products-item" slot="header" lines="none">
            <ion-label>All Products | {{searchLoadedProducts.length}}</ion-label>
            <ion-icon name="list-outline" slot="start"></ion-icon>
          </ion-item>
      
          <!-- Results Bar -->
          <ion-list slot="content">
            <ion-row class="ion-justify-content-center">
              <ion-col size-xs="11" size-sm="10" size-md="8" size-lg="8">
                <h3>Categories:</h3>
              </ion-col>

              <ion-col size-xs="12" size-sm="12" size-md="10" size-lg="8">

                <!-- Categories Swiper -->
                <swiper
                  id="category-swiper"
                  [config]="categorySwiperConfig" 
                  (swiper)="onSwiper($event)">

                    <ng-template swiperSlide>
                      <ion-button 
                        (click)="changeCategory('all', $event)"
                        [ngClass]="this.activeCategory == 'all' ? 'active-category category' : 'category'">
                        All
                      </ion-button>
                    </ng-template>
                    <ng-template swiperSlide>
                      <ion-button 
                        (click)="changeCategory('relaxation', $event)" 
                        [ngClass]="this.activeCategory == 'relaxation' ? 'active-category category' : 'category'">
                        Relaxation
                      </ion-button>
                    </ng-template>
                    <ng-template swiperSlide>
                      <ion-button 
                        (click)="changeCategory('sleep', $event)" 
                        [ngClass]="this.activeCategory == 'sleep' ? 'active-category category' : 'category'">
                        Sleep
                      </ion-button>
                    </ng-template>
                    <ng-template swiperSlide>
                      <ion-button 
                        (click)="changeCategory('relationships', $event)"  
                        [ngClass]="this.activeCategory == 'relationships' ? 'active-category category' : 'category'">
                        Relationships
                      </ion-button>
                    </ng-template>
                    <ng-template swiperSlide>
                      <ion-button 
                        (click)="changeCategory('self-improvement', $event)"
                        [ngClass]="this.activeCategory == 'self-improvement' ? 'active-category category' : 'category'">
                        Self-Improvement
                      </ion-button>
                    </ng-template>
                    <ng-template swiperSlide>
                      <ion-button 
                        (click)="changeCategory('business', $event)" 
                        [ngClass]="this.activeCategory == 'business' ? 'active-category category' : 'category'">
                        Business
                      </ion-button>
                    </ng-template>
                </swiper>

              </ion-col>

              <h5 id="results-header">Results: {{filterOption}} ({{searchLoadedProducts.length}})</h5>
            </ion-row> 

            <!-- If No Search Results -->
            <ion-row *ngIf="searchLoadedProducts.length == 0" class="ion-justify-content-center">
              <ion-col size-xs="11" size-sm="10" size-md="8" size-lg="8">
                <p id="no-search-results">
                  <ion-icon name="search-outline"></ion-icon>
                  No Search Results. Please try again</p>
              </ion-col>
            </ion-row>

            <div id="fab-visible-position"></div>

            <!-- Products -->
            <div *ngFor="let product of searchLoadedProducts">
                <ion-row
                class="product-wrapper ion-justify-content-center">
                <ion-col (click)="this.goToProductPage()" class="product-photo" size="6">
          
                </ion-col>
                <ion-col size="6">
                  <div (click)="this.goToProductPage()">
                    <p class="product-price">${{product.price}}</p>
                    <h6 class="product-title">{{product.title}}</h6>
                    <h6 class="product-rating">Rating: {{product.rating}}</h6>
                    <p class="duration">Duration: {{product.duration}} Mins</p>
                    <p class="product-category"># {{product.category}}</p>
                    <h5 class="product-reviews-length">Reviews {{product.reviews.length}}</h5>
                  </div>
                  <div class="product-message-green"></div>
                  <div class="product-message-red"></div>
                  <ion-toolbar>
                    <ion-buttons slot="end">
                      <ion-button class="favorite-this-product-button" (click)="favorites()">
                        <ion-icon slot="start" name="heart"></ion-icon>
                      </ion-button>
                    </ion-buttons>
                  </ion-toolbar>
                </ion-col>
                </ion-row>
            </div>

          </ion-list>

        </ion-accordion>
      </ion-accordion-group>

    </ng-container>

  </ion-grid>

  <ion-fab 
    (click)="scrollToTop()"
    id="fab-button" 
    vertical="bottom" 
    horizontal="end" 
    slot="fixed">
    <ion-fab-button>
      <ion-icon name="chevron-up-outline"></ion-icon>
    </ion-fab-button>
  </ion-fab>
</ion-content>
